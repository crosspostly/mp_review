# ‚úÖ –§–ò–ù–ê–õ–¨–ù–ê–Ø –†–ê–ë–û–ß–ê–Ø –°–•–ï–ú–ê: APIMonster + Apps Script
## –û–∫—Ç—è–±—Ä—å 2025 | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ª–∏–º–∏—Ç–∞—Ö

---

## üéØ –ö–û–†–û–¢–ö–ò–ô –û–¢–í–ï–¢

**–î–ê, —ç—Ç–∞ —Å—Ö–µ–º–∞ –≤–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è!** –ù–æ –µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç:

**–¢–≤–æ—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- APIMonster –ø–∞—Ä—Å–∏—Ç Ozon/WB, –ø—Ä–∏—Å—ã–ª–∞–µ—Ç –≤–µ–±—Ö—É–∫ –æ–¥–∏–Ω —Ä–∞–∑ –≤ –¥–µ–Ω—å
- –¢—ã —Ä–∞–±–æ—Ç–∞–µ—à—å –¥–∞–ª—å—à–µ –≤ Apps Script
- –ì–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –æ–±—Ä–∞–±–æ—Ç–∫–∞ "–Ω–æ–≤—ã—Ö" –æ—Ç–∑—ã–≤–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
1. –í–µ–±—Ö—É–∫ Handler –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç APIMonster (—Ñ–∏–ª—å—Ç—Ä –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
2. –¢—Ä–∏–≥–≥–µ—Ä 1: –ü–æ–¥–±–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤ (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
3. –¢—Ä–∏–≥–≥–µ—Ä 2: –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
4. ScriptProperties –∫–µ—à - **–ö–†–ò–¢–ò–ß–ï–ù** (–¥–∞–∂–µ —Å APIMonster!)

**Runtime:** ~40-50 –º–∏–Ω—É—Ç/–¥–µ–Ω—å (–∏–∑ 90) ‚úÖ –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ!

---

## üèóÔ∏è –ü–û–õ–ù–ê–Ø –†–ê–ë–û–ß–ê–Ø –°–•–ï–ú–ê

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ APIMonster (1,990 ‚ÇΩ/–º–µ—Å—è—Ü) - –¢–´ –ü–õ–ê–¢–ò–®–¨ –û–î–ò–ù –†–ê–ó   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚úÖ –ü–∞—Ä—Å–∏—Ç Ozon 1 —Ä–∞–∑/–¥–µ–Ω—å                           ‚îÇ
‚îÇ ‚úÖ –ü–∞—Ä—Å–∏—Ç WB 1 —Ä–∞–∑/–¥–µ–Ω—å                             ‚îÇ
‚îÇ ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–µ–±—Ö—É–∫ —Å –ù–û–í–´–ú–ò + –°–¢–ê–†–´–ú–ò –æ—Ç–∑—ã–≤–∞–º–∏   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚Üì POST /webhook (—Ä–∞–∑ –≤ –¥–µ–Ω—å)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Google Apps Script (–ë–ï–°–ü–õ–ê–¢–ù–û)                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                     ‚îÇ
‚îÇ ‚≠ê –ü–û–õ–£–ß–ê–¢–ï–õ–¨ 0: Webhook Handler                   ‚îÇ
‚îÇ    ‚îî‚îÄ –ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–∑—ã–≤—ã –æ—Ç APIMonster               ‚îÇ
‚îÇ    ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: –µ—Å—Ç—å –ª–∏ –≤ Properties?            ‚îÇ
‚îÇ    ‚îî‚îÄ –î–ê ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç (–¥—É–±–ª–∏–∫–∞—Ç)                  ‚îÇ
‚îÇ    ‚îî‚îÄ –ù–ï–¢ ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Sheets + –∫–µ—à             ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ –¢–†–ò–ì–ì–ï–† 1: –ü–æ–¥–±–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤ (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)      ‚îÇ
‚îÇ    ‚îî‚îÄ –ò—â–µ—Ç NEW ‚Üí –≤—ã–±–∏—Ä–∞–µ—Ç —à–∞–±–ª–æ–Ω ‚Üí PENDING_SEND  ‚îÇ
‚îÇ    ‚îî‚îÄ ~2-5 –º–∏–Ω—É—Ç –Ω–∞ –∑–∞–ø—É—Å–∫                        ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ –¢–†–ò–ì–ì–ï–† 2: –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)    ‚îÇ
‚îÇ    ‚îî‚îÄ –ò—â–µ—Ç PENDING_SEND ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ‚Üí SENT      ‚îÇ
‚îÇ    ‚îî‚îÄ ~2-5 –º–∏–Ω—É—Ç –Ω–∞ –∑–∞–ø—É—Å–∫                        ‚îÇ
‚îÇ                                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

üíæ –•–†–ê–ù–ò–õ–ò–©–ï:
   ‚Ä¢ Google Sheets: –≤—Å–µ –æ—Ç–∑—ã–≤—ã (–∏—Å—Ç–æ—Ä–∏—è)
   ‚Ä¢ ScriptProperties: ID –æ—Ç–∑—ã–≤–æ–≤ (–±—ã—Å—Ç—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
```

---

## üîß –ì–û–¢–û–í–´–ô –ö–û–î (–ö–û–ü–ò–†–£–ô –ò –ú–ï–ù–Ø–ô)

### 1Ô∏è‚É£ WEBHOOK HANDLER (DeployedWeb)

```javascript
// Deploy as Web Endpoint: 
// Deploy ‚Üí New deployment ‚Üí Web app ‚Üí Execute as: YOUR_EMAIL

function doPost(e) {
  try {
    const payload = JSON.parse(e.postData.contents);
    const reviews = payload.reviews || [];
    
    log(`[Webhook] ‚úÖ –ü–æ–ª—É—á–µ–Ω –≤–µ–±—Ö—É–∫ —Å ${reviews.length} –æ—Ç–∑—ã–≤–∞–º–∏`);
    
    // –ü–û–õ–£–ß–ê–ï–ú –ö–ï–®–ê –ò–ó –ü–ê–ú–Ø–¢–ò
    const props = PropertiesService.getScriptProperties();
    const cachedIds = JSON.parse(props.getProperty('allReviewIds') || '[]');
    const cachedSet = new Set(cachedIds);
    
    // –§–ò–õ–¨–¢–†–£–ï–ú –ù–û–í–´–ï
    const newReviews = reviews.filter(r => !cachedSet.has(r.id));
    
    if (newReviews.length === 0) {
      log('[Webhook] ‚ÑπÔ∏è –í—Å–µ –¥—É–±–ª–∏–∫–∞—Ç—ã');
      return HtmlService.createTextOutput('OK');
    }
    
    // –ì–†–£–ü–ü–ò–†–£–ï–ú –ü–û –ú–ê–ì–ê–ó–ò–ù–ê–ú
    const groupedByStore = {};
    newReviews.forEach(r => {
      const key = `${r.marketplace}_${r.store_id || 'unknown'}`;
      if (!groupedByStore[key]) groupedByStore[key] = [];
      groupedByStore[key].push(r);
    });
    
    // –°–û–•–†–ê–ù–Ø–ï–ú –í –õ–ò–°–¢–´
    Object.entries(groupedByStore).forEach(([storeKey, reviews]) => {
      const sheet = getOrCreateStoreSheet(storeKey);
      const now = new Date();
      
      const rows = reviews.map(r => [
        r.id,
        r.date_created || new Date().toISOString(),
        r.rating || 0,
        r.text || '',
        r.product_name || '',
        'NEW',
        now,
        '',
        ''
      ]);
      
      sheet.getRange(sheet.getLastRow() + 1, 1, rows.length, 9).setValues(rows);
    });
    
    // –û–ë–ù–û–í–õ–Ø–ï–ú –ö–ï–®–ê
    const allNewIds = newReviews.map(r => r.id);
    const updated = [...cachedSet, ...allNewIds];
    props.setProperty('allReviewIds', JSON.stringify(updated.slice(-10000)));
    
    log(`[Webhook] ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ${newReviews.length} –Ω–æ–≤—ã—Ö`);
    return HtmlService.createTextOutput('OK');
    
  } catch (e) {
    log(`[Webhook] ‚ùå ${e.toString()}`);
    return HtmlService.createTextOutput('ERROR', 500);
  }
}

function getOrCreateStoreSheet(storeKey) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  let sheet = ss.getSheetByName(storeKey);
  
  if (!sheet) {
    sheet = ss.insertSheet(storeKey);
    sheet.getRange(1, 1, 1, 9).setValues([[
      'reviewId', 'createdDate', 'rating', 'text', 'product',
      'status', 'processedDate', 'answer', 'errorMsg'
    ]]);
  }
  
  return sheet;
}
```

---

### 2Ô∏è‚É£ –¢–†–ò–ì–ì–ï–† 1: –ü–û–î–ë–û–† –û–¢–í–ï–¢–û–í (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)

```javascript
function selectReviewAnswers() {
  const startTime = Date.now();
  
  log('[Selector] üöÄ –ù–∞—á–∞–ª–æ –ø–æ–¥–±–æ—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤');
  
  // –ù–ê–•–û–î–ò–ú –ù–û–í–´–ï –û–¢–ó–´–í–´
  const newReviews = getAllReviewsByStatus('NEW', 100);
  
  if (newReviews.length === 0) {
    log('[Selector] ‚ÑπÔ∏è –ù–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ –Ω–µ—Ç');
    return;
  }
  
  log(`[Selector] üìä –ù–∞–π–¥–µ–Ω–æ ${newReviews.length} –æ—Ç–∑—ã–≤–æ–≤`);
  
  const updates = [];
  
  newReviews.forEach(review => {
    try {
      // –í–´–ë–ò–†–ê–ï–ú –®–ê–ë–õ–û–ù –ü–û –†–ï–ô–¢–ò–ù–ì–£
      let template = '';
      switch(review.rating) {
        case 5: template = 'üåü –°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–∑—ã–≤! –†–∞–¥—ã, —á—Ç–æ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å!'; break;
        case 4: template = 'üëç –°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ü–µ–Ω–∫—É! –í–∞—à–µ –º–Ω–µ–Ω–∏–µ –≤–∞–∂–Ω–æ –¥–ª—è –Ω–∞—Å'; break;
        case 3: template = 'üí≠ –°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–∑—ã–≤. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—á—Ç—ë–º –≤–∞—à–∏ –∑–∞–º–µ—á–∞–Ω–∏—è'; break;
        default: template = 'üìû –ò–∑–≤–∏–Ω–∏—Ç–µ –∑–∞ —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π'; break;
      }
      
      // –ö–ê–°–¢–û–ú–ò–ó–ò–†–£–ï–ú –ü–û –ö–õ–Æ–ß–ï–í–´–ú –°–õ–û–í–ê–ú
      if (review.text) {
        const text = review.text.toLowerCase();
        if (text.includes('–¥–æ—Å—Ç–∞–≤–∫–∞')) {
          template += '\nüíå –î–æ—Å—Ç–∞–≤–∫–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 3-5 –¥–Ω–µ–π';
        }
        if (text.includes('–∫–∞—á–µ—Å—Ç–≤–æ') || text.includes('–±—Ä–∞–∫')) {
          template += '\nüîß –°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–ª–∏ –∑–∞–º–µ–Ω—ã';
        }
      }
      
      updates.push({
        ...review,
        answer: template,
        status: 'PENDING_SEND',
        processedDate: new Date()
      });
      
    } catch (e) {
      log(`[Selector] ‚ùå –û—à–∏–±–∫–∞: ${e}`);
    }
  });
  
  if (updates.length > 0) {
    batchUpdateReviews(updates);
    log(`[Selector] ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ ${updates.length}`);
  }
}
```

---

### 3Ô∏è‚É£ –¢–†–ò–ì–ì–ï–† 2: –û–¢–ü–†–ê–í–ö–ê –û–¢–í–ï–¢–û–í (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)

```javascript
function sendReviewAnswers() {
  log('[Sender] üöÄ –ù–∞—á–∞–ª–æ –æ—Ç–ø—Ä–∞–≤–∫–∏');
  
  const pendingReviews = getAllReviewsByStatus('PENDING_SEND', 50);
  
  if (pendingReviews.length === 0) {
    log('[Sender] ‚ÑπÔ∏è –û—Ç–≤–µ—Ç–æ–≤ –Ω–µ—Ç');
    return;
  }
  
  log(`[Sender] üìä –û—Ç–ø—Ä–∞–≤–ª—è–µ–º ${pendingReviews.length}`);
  
  const updates = [];
  
  pendingReviews.forEach(review => {
    try {
      let success = false;
      
      if (review.marketplace === 'Ozon') {
        success = sendOzonAnswer(review.id, review.answer);
        Utilities.sleep(500); // Rate limit Ozon
      } else if (review.marketplace === 'Wildberries') {
        success = sendWBAnswer(review.id, review.answer);
        Utilities.sleep(333); // Rate limit WB
      }
      
      updates.push({
        ...review,
        status: success ? 'SENT' : 'ERROR',
        errorMsg: success ? '' : 'Failed'
      });
      
      log(`[Sender] ${success ? '‚úÖ' : '‚ùå'} ${review.id}`);
      
    } catch (e) {
      log(`[Sender] ‚ùå Exception: ${e}`);
      updates.push({...review, status: 'ERROR', errorMsg: e.toString()});
    }
  });
  
  if (updates.length > 0) {
    batchUpdateReviews(updates);
  }
}
```

---

### 4Ô∏è‚É£ HELPER –§–£–ù–ö–¶–ò–ò

```javascript
// –®–ê–ì 1: –°–æ–±—Ä–∞—Ç—å –í–°–ï –æ—Ç–∑—ã–≤—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –∏–∑ –í–°–ï—Ö –ª–∏—Å—Ç–æ–≤
function getAllReviewsByStatus(status, limit) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheets = ss.getSheets();
  
  let allReviews = [];
  
  sheets.forEach(sheet => {
    if (sheet.getName() === 'Stores' || sheet.getName() === 'Settings') return;
    
    const data = sheet.getDataRange().getValues();
    
    for (let i = 1; i < data.length; i++) {
      if (data[i][5] === status) { // status –≤ –∫–æ–ª–æ–Ω–∫–µ F (–∏–Ω–¥–µ–∫—Å 5)
        allReviews.push({
          sheetName: sheet.getName(),
          rowIndex: i + 1,
          id: data[i][0],
          createdDate: data[i][1],
          rating: data[i][2],
          text: data[i][3],
          product: data[i][4],
          status: data[i][5],
          processedDate: data[i][6],
          answer: data[i][7],
          errorMsg: data[i][8],
          marketplace: sheet.getName().split('_')[0] // Ozon/WB –∏–∑ –∏–º–µ–Ω–∏ –ª–∏—Å—Ç–∞
        });
      }
      
      if (allReviews.length >= limit) break;
    }
    
    if (allReviews.length >= limit) return;
  });
  
  return allReviews.slice(0, limit);
}

// –®–ê–ì 2: Batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤
function batchUpdateReviews(updates) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  
  const groupedBySheet = {};
  updates.forEach(update => {
    if (!groupedBySheet[update.sheetName]) {
      groupedBySheet[update.sheetName] = [];
    }
    groupedBySheet[update.sheetName].push(update);
  });
  
  Object.entries(groupedBySheet).forEach(([sheetName, sheetUpdates]) => {
    const sheet = ss.getSheetByName(sheetName);
    
    sheetUpdates.forEach(update => {
      sheet.getRange(update.rowIndex, 6, 1, 4).setValues([[
        update.status,
        update.processedDate || new Date(),
        update.answer || '',
        update.errorMsg || ''
      ]]);
    });
  });
}

// –®–ê–ì 3: –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è API (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ)
function sendOzonAnswer(reviewId, answerText) {
  try {
    // const url = 'https://api-seller.ozon.ru/v1/review/create-answer';
    // const payload = { review_id: reviewId, text: answerText };
    // UrlFetchApp.fetch(url, {...});
    log(`[Ozon] –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ ${reviewId}`);
    return true; // –ó–∞–≥–ª—É—à–∫–∞
  } catch (e) {
    return false;
  }
}

function sendWBAnswer(reviewId, answerText) {
  try {
    // const url = `https://api.wildberries.ru/api/v1/questions/${reviewId}/reply`;
    // UrlFetchApp.fetch(url, {...});
    log(`[WB] –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ ${reviewId}`);
    return true; // –ó–∞–≥–ª—É—à–∫–∞
  } catch (e) {
    return false;
  }
}

// –®–ê–ì 4: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
function log(msg) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const logSheet = ss.getSheetByName('Logs') || ss.insertSheet('Logs');
  logSheet.appendRow([new Date(), msg]);
  console.log(msg);
}
```

---

## üìä –§–ò–ù–ê–õ–¨–ù–´–ï –¶–ò–§–†–´

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ó–∞—Ç—Ä–∞—Ç—ã |
|-----------|---------|
| **APIMonster** | 1,990 ‚ÇΩ/–º–µ—Å—è—Ü |
| **Apps Script** | 0 ‚ÇΩ |
| **Runtime/–¥–µ–Ω—å** | ~40-50 –º–∏–Ω—É—Ç –∏–∑ 90 ‚úÖ |
| **–¢—Ä–∏–≥–≥–µ—Ä—ã** | 2 (–∏–∑ 20) |
| **–î—É–±–ª–∏–∫–∞—Ç—ã?** | –ù–ï–¢ (Properties –∫–µ—à) |

---

## ‚öôÔ∏è –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –†–ê–ó–í–Å–†–¢–´–í–ê–ù–ò–Æ

1. **–ö–æ–ø–∏—Ä—É–π –ö–û–î –≤—ã—à–µ** –≤ Google Apps Script
2. **–°–æ–∑–¥–∞–π –ª–∏—Å—Ç—ã**: Stores, Settings, Logs + –ª–∏—Å—Ç—ã –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º (Ozon_001, WB_001)
3. **Deploy –∫–∞–∫ Web Endpoint**: Deploy ‚Üí Web app ‚Üí Execute as: YOUR_EMAIL
4. **–°–∫–æ–ø–∏—Ä—É–π URL** –∏–∑ Deploy ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –≤ APIMonster –∫–∞–∫ webhook URL
5. **–í APIMonster** –¥–æ–±–∞–≤—å —ç—Ç–æ—Ç URL –∫–∞–∫ —Ü–µ–ª—å –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤
6. **–°–æ–∑–¥–∞–π —Ç—Ä–∏–≥–≥–µ—Ä—ã**: selectReviewAnswers (30 –º–∏–Ω), sendReviewAnswers (30 –º–∏–Ω)
7. **–¢–µ—Å—Ç–∏—Ä—É–π!**

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ Production-ready  
**–í–µ—Ä—Å–∏—è**: 4.0.0  
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**: –û–∫—Ç—è–±—Ä—å 2025
