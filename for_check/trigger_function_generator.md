# üéØ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –§—É–Ω–∫—Ü–∏–π –¥–ª—è –¢—Ä–∏–≥–≥–µ—Ä–æ–≤

## –ü—Ä–æ–±–ª–µ–º–∞

Google Apps Script **–ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –≤ runtime**. 

–¢—Ä–∏–≥–≥–µ—Ä—ã —Ç—Ä–µ–±—É—é—Ç, —á—Ç–æ–±—ã —Ñ—É–Ω–∫—Ü–∏—è-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∞ –≤ –∫–æ–¥–µ **–î–û** —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–∞.

## –†–µ—à–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** —Å–æ–∑–¥–∞–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ –ø—Ä–∏:
1. –î–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ —á–µ—Ä–µ–∑ HTML —Ñ–æ—Ä–º—É
2. –í–∫–ª—é—á–µ–Ω–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ (–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ ON)
3. –û—Ç–∫—Ä—ã—Ç–∏–∏ —Ç–∞–±–ª–∏—Ü—ã (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

```javascript
// –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ (saveStore)
function saveStore(store) {
  // ... —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Properties ...
  
  // üéØ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –°–û–ó–î–ê–ù–ò–ï –¢–†–ò–ì–ì–ï–†–ê
  const triggerInterval = getTriggerInterval(); // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 5 –º–∏–Ω—É—Ç
  ensureStoreTrigger(store, triggerInterval);
  
  // –¢—Ä–∏–≥–≥–µ—Ä —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –∏–º–µ–Ω–µ–º —Ñ—É–Ω–∫—Ü–∏–∏: processStore_<storeId>
  // –ù–∞–ø—Ä–∏–º–µ—Ä: processStore_1729526400000
}
```

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!

–î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ **–ù–ï–û–ë–•–û–î–ò–ú–û** –¥–æ–±–∞–≤–∏—Ç—å –≤ `code.gs` –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ ID –º–∞–≥–∞–∑–∏–Ω–∞.

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ `code.gs`:

```javascript
// ============ –ê–í–¢–û–ì–ï–ù–ï–†–ò–†–£–ï–ú–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –¢–†–ò–ì–ì–ï–†–û–í ============
// –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
// ‚ö†Ô∏è –ù–ï –£–î–ê–õ–Ø–ô–¢–ï —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ - –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏!

// –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä: —Å–æ–∑–¥–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö timestamp-based ID
// –ü–æ–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω: 2020-2030 –≥–æ–¥—ã (timestamp –æ—Ç 1577836800000 –¥–æ 1893456000000)

// –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: Google Apps Script –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º 500 —Ñ—É–Ω–∫—Ü–∏–π –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
// –ü–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–£–Æ –°–ò–°–¢–ï–ú–£ —á–µ—Ä–µ–∑ eval() –∏–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥

// üöÄ –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï: –û–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è-—Ä–æ—É—Ç–µ—Ä –¥–ª—è –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
function processTriggerStore() {
  // –ü–æ–ª—É—á–∞–µ–º ID –º–∞–≥–∞–∑–∏–Ω–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞
  const functionName = arguments.callee.name;
  
  // –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ ID –∏–∑ Properties –∏ –≤—ã–∑—ã–≤–∞–µ–º processSingleStoreById
  const props = PropertiesService.getScriptProperties();
  const allProps = props.getProperties();
  
  Object.keys(allProps).forEach(key => {
    if (key.startsWith('store_')) {
      const storeId = key.replace('store_', '');
      processSingleStoreById(storeId);
    }
  });
}
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–í–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ ID, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–û–î–ò–ù –æ–±—â–∏–π —Ç—Ä–∏–≥–≥–µ—Ä**:

```javascript
// –û–¥–∏–Ω —Ç—Ä–∏–≥–≥–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã
function processAllActiveStores() {
  const devMode = isDevMode();
  log(`--- –ó–ê–ü–£–°–ö –û–ë–†–ê–ë–û–¢–ö–ò –í–°–ï–• –ê–ö–¢–ò–í–ù–´–• –ú–ê–ì–ê–ó–ò–ù–û–í (${devMode ? 'DEV' : 'PROD'}) ---`);
  
  const allStores = getStores();
  const activeStores = allStores.filter(store => store.isActive);
  
  if (activeStores.length === 0) {
    log('–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.');
    return;
  }
  
  log(`–ù–∞–π–¥–µ–Ω–æ ${activeStores.length} –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤.`);
  
  activeStores.forEach((store, index) => {
    log(`--- [${index + 1}/${activeStores.length}] –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞: ${store.name} [${store.marketplace}] ---`);
    processSingleStore(store, devMode);
    log(`--- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞: ${store.name} ---`);
    
    // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –º–∞–≥–∞–∑–∏–Ω–∞–º–∏
    if (index < activeStores.length - 1) {
      Utilities.sleep(2000);
    }
  });
  
  log('--- –û–ë–†–ê–ë–û–¢–ö–ê –í–°–ï–• –ê–ö–¢–ò–í–ù–´–• –ú–ê–ì–ê–ó–ò–ù–û–í –ó–ê–í–ï–†–®–ï–ù–ê ---');
}
```

## –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ **–£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–ê** –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞** —á–µ—Ä–µ–∑ HTML —Ñ–æ—Ä–º—É:
   - `saveStore()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç `ensureStoreTrigger()`
   - –°–æ–∑–¥–∞–µ—Ç—Å—è —Ç—Ä–∏–≥–≥–µ—Ä —Å –∏–º–µ–Ω–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ `processStore_<ID>`
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–∞–≥–∞–∑–∏–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ ScriptProperties

2. **–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏/–≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞**:
   - –¢—Ä–∏–≥–≥–µ—Ä —Å–æ–∑–¥–∞–µ—Ç—Å—è/—É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è

3. **–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ç–∞–±–ª–∏—Ü—ã** (—Ñ—É–Ω–∫—Ü–∏—è `onOpen`):
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `syncAllStoreTriggers()`
   - –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤—Å–µ –º–∞–≥–∞–∑–∏–Ω—ã –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã
   - –°–æ–∑–¥–∞—é—Ç—Å—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã
   - –£–¥–∞–ª—è—é—Ç—Å—è —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö/—É–¥–∞–ª–µ–Ω–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤

4. **–§—É–Ω–∫—Ü–∏—è-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç—Ä–∏–≥–≥–µ—Ä–∞**:
   ```javascript
   function processSingleStoreById(storeId) {
     // –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ Properties
     // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —ç—Ç–æ—Ç –º–∞–≥–∞–∑–∏–Ω
   }
   ```

## –ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏

**Google Apps Script –ù–ï –ú–û–ñ–ï–¢:**
- –°–æ–∑–¥–∞–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ `eval()`
- –°–æ–∑–¥–∞–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ `new Function()`
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å

**–†–ï–®–ï–ù–ò–ï:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–û–î–ò–ù –æ–±—â–∏–π —Ç—Ä–∏–≥–≥–µ—Ä** –≤–º–µ—Å—Ç–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞.

## –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ò–°–ü–û–õ–¨–ó–£–ô–¢–ï —Å–∏—Å—Ç–µ–º—É —Å –æ–¥–Ω–∏–º –æ–±—â–∏–º —Ç—Ä–∏–≥–≥–µ—Ä–æ–º `processAllStores()`**:
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –ü—Ä–æ—â–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã

–°–∏—Å—Ç–µ–º–∞ **—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `processAllStores()` –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
