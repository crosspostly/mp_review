#!/bin/bash

# ๐๏ธ ะกะบัะธะฟั ะดะปั ัะดะฐะปะตะฝะธั ัััะฐัะตะฒัะธั ัะดะฐะปะตะฝะฝัั ะฒะตัะพะบ
# ะัะฟะพะปะฝัะนัะต ะะะกะะ ัะปะธัะฝะธั PR cleanup/remove-outdated-content ะฒ main

echo "๐๏ธ ะฃะดะฐะปะตะฝะธะต ัััะฐัะตะฒัะธั ัะดะฐะปะตะฝะฝัั ะฒะตัะพะบ..."
echo ""
echo "โ๏ธ  ะะะะะะะะ: ะญัะธ ะฒะตัะบะธ ะฑัะดัั ัะดะฐะปะตะฝั ะะะะกะะะะ!"
echo "ะฃะฑะตะดะธัะตัั, ััะพ ะฒัะต ะฝัะถะฝัะต ะธะทะผะตะฝะตะฝะธั ัะถะต ะฒ main."
echo ""
read -p "ะัะพะดะพะปะถะธัั? (y/N) " -n 1 -r
echo ""

if [[ ! $REPLY =~ ^[Yy]$ ]]
then
    echo "ะัะผะตะฝะตะฝะพ."
    exit 1
fi

echo ""
echo "๐ ะะฐัะธะฝะฐะตะผ ัะดะฐะปะตะฝะธะต..."
echo ""

# ะกะฟะธัะพะบ ะฒะตัะพะบ ะดะปั ัะดะฐะปะตะฝะธั
branches=(
    "cursor/develop-implementation-plan-d6a3"
    "cursor/fix-wb-api-and-ozon-trigger-errors-f88b"
    "cursor/investigate-missing-google-sheets-menu-3a89"
    "cursor/update-and-compare-script-files-and-documentation-490b"
    "working"
)

# ะกัะตััะธะบะธ
deleted=0
failed=0

# ะฃะดะฐะปัะตะผ ะบะฐะถะดัั ะฒะตัะบั
for branch in "${branches[@]}"
do
    echo "๐๏ธ  ะฃะดะฐะปะตะฝะธะต ะฒะตัะบะธ: $branch"
    if git push origin --delete "$branch" 2>&1; then
        echo "   โ ะฃะดะฐะปะตะฝะฐ: $branch"
        ((deleted++))
    else
        echo "   โ ะัะธะฑะบะฐ ะฟัะธ ัะดะฐะปะตะฝะธะธ: $branch"
        ((failed++))
    fi
    echo ""
done

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "๐ ะัะพะณะธ:"
echo "   โ ะฃะดะฐะปะตะฝะพ: $deleted ะฒะตัะพะบ"
if [ $failed -gt 0 ]; then
    echo "   โ ะัะธะฑะพะบ: $failed"
fi
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

if [ $deleted -eq ${#branches[@]} ]; then
    echo "๐ ะัะต ะฒะตัะบะธ ััะฟะตัะฝะพ ัะดะฐะปะตะฝั!"
else
    echo "โ๏ธ  ะะตะบะพัะพััะต ะฒะตัะบะธ ะฝะต ัะดะฐะปะตะฝั. ะัะพะฒะตัััะต ะพัะธะฑะบะธ ะฒััะต."
fi

echo ""
echo "๐ ะะฑะฝะพะฒะปะตะฝะธะต ะปะพะบะฐะปัะฝะพะณะพ ัะตะฟะพะทะธัะพัะธั..."
git fetch --prune

echo ""
echo "โ ะะพัะพะฒะพ!"
